{"ast":null,"code":"import { UAParser } from 'ua-parser-js';\nimport { MAX_CHALLENGES } from '../constants/settings';\nimport { GAME_TITLE } from '../constants/strings';\nimport { getGuessStatuses } from './statuses';\nimport { solutionIndex, unicodeSplit } from './words';\nconst webShareApiDeviceTypes = ['mobile', 'smarttv', 'wearable'];\nconst parser = new UAParser();\nconst browser = parser.getBrowser();\nconst device = parser.getDevice();\nexport const shareStatus = (solution, guesses, lost, isHardMode, isDarkMode, isHighContrastMode, handleShareToClipboard, handleShareFailure) => {\n  const textToShare = `${GAME_TITLE} ${solutionIndex} ${lost ? 'X' : guesses.length}/${MAX_CHALLENGES}${isHardMode ? '*' : ''}\\n\\n` + generateEmojiGrid(solution, guesses, getEmojiTiles(isDarkMode, isHighContrastMode));\n  const shareData = {\n    text: textToShare\n  };\n  let shareSuccess = false;\n\n  try {\n    if (attemptShare(shareData)) {\n      navigator.share(shareData);\n      shareSuccess = true;\n    }\n  } catch (error) {\n    shareSuccess = false;\n  }\n\n  try {\n    if (!shareSuccess) {\n      if (navigator.clipboard) {\n        navigator.clipboard.writeText(textToShare).then(handleShareToClipboard).catch(handleShareFailure);\n      } else {\n        handleShareFailure();\n      }\n    }\n  } catch (error) {\n    handleShareFailure();\n  }\n};\nexport const generateEmojiGrid = (solution, guesses, tiles) => {\n  return guesses.map(guess => {\n    const status = getGuessStatuses(solution, guess);\n    const splitGuess = unicodeSplit(guess);\n    return splitGuess.map((_, i) => {\n      switch (status[i]) {\n        case 'correct':\n          return tiles[0];\n\n        case 'present':\n          return tiles[1];\n\n        default:\n          return tiles[2];\n      }\n    }).join('');\n  }).join('\\n');\n};\n\nconst attemptShare = shareData => {\n  var _browser$name, _device$type;\n\n  return (// Deliberately exclude Firefox Mobile, because its Web Share API isn't working correctly\n    ((_browser$name = browser.name) === null || _browser$name === void 0 ? void 0 : _browser$name.toUpperCase().indexOf('FIREFOX')) === -1 && webShareApiDeviceTypes.indexOf((_device$type = device.type) !== null && _device$type !== void 0 ? _device$type : '') !== -1 && navigator.canShare && navigator.canShare(shareData) && navigator.share\n  );\n};\n\nconst getEmojiTiles = (isDarkMode, isHighContrastMode) => {\n  let tiles = [];\n  tiles.push(isHighContrastMode ? 'ğŸŸ§' : 'ğŸŸ©');\n  tiles.push(isHighContrastMode ? 'ğŸŸ¦' : 'ğŸŸ¨');\n  tiles.push(isDarkMode ? 'â¬›' : 'â¬œ');\n  return tiles;\n};","map":{"version":3,"sources":["/Users/anthonydelorie/Git/react-wordle/src/lib/share.ts"],"names":["UAParser","MAX_CHALLENGES","GAME_TITLE","getGuessStatuses","solutionIndex","unicodeSplit","webShareApiDeviceTypes","parser","browser","getBrowser","device","getDevice","shareStatus","solution","guesses","lost","isHardMode","isDarkMode","isHighContrastMode","handleShareToClipboard","handleShareFailure","textToShare","length","generateEmojiGrid","getEmojiTiles","shareData","text","shareSuccess","attemptShare","navigator","share","error","clipboard","writeText","then","catch","tiles","map","guess","status","splitGuess","_","i","join","name","toUpperCase","indexOf","type","canShare","push"],"mappings":"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","sourcesContent":["import { UAParser } from 'ua-parser-js'\n\nimport { MAX_CHALLENGES } from '../constants/settings'\nimport { GAME_TITLE } from '../constants/strings'\nimport { getGuessStatuses } from './statuses'\nimport { solutionIndex, unicodeSplit } from './words'\n\nconst webShareApiDeviceTypes: string[] = ['mobile', 'smarttv', 'wearable']\nconst parser = new UAParser()\nconst browser = parser.getBrowser()\nconst device = parser.getDevice()\n\nexport const shareStatus = (\n  solution: string,\n  guesses: string[],\n  lost: boolean,\n  isHardMode: boolean,\n  isDarkMode: boolean,\n  isHighContrastMode: boolean,\n  handleShareToClipboard: () => void,\n  handleShareFailure: () => void\n) => {\n  const textToShare =\n    `${GAME_TITLE} ${solutionIndex} ${\n      lost ? 'X' : guesses.length\n    }/${MAX_CHALLENGES}${isHardMode ? '*' : ''}\\n\\n` +\n    generateEmojiGrid(\n      solution,\n      guesses,\n      getEmojiTiles(isDarkMode, isHighContrastMode)\n    )\n\n  const shareData = { text: textToShare }\n\n  let shareSuccess = false\n\n  try {\n    if (attemptShare(shareData)) {\n      navigator.share(shareData)\n      shareSuccess = true\n    }\n  } catch (error) {\n    shareSuccess = false\n  }\n\n  try {\n    if (!shareSuccess) {\n      if (navigator.clipboard) {\n        navigator.clipboard\n          .writeText(textToShare)\n          .then(handleShareToClipboard)\n          .catch(handleShareFailure)\n      } else {\n        handleShareFailure()\n      }\n    }\n  } catch (error) {\n    handleShareFailure()\n  }\n}\n\nexport const generateEmojiGrid = (\n  solution: string,\n  guesses: string[],\n  tiles: string[]\n) => {\n  return guesses\n    .map((guess) => {\n      const status = getGuessStatuses(solution, guess)\n      const splitGuess = unicodeSplit(guess)\n\n      return splitGuess\n        .map((_, i) => {\n          switch (status[i]) {\n            case 'correct':\n              return tiles[0]\n            case 'present':\n              return tiles[1]\n            default:\n              return tiles[2]\n          }\n        })\n        .join('')\n    })\n    .join('\\n')\n}\n\nconst attemptShare = (shareData: object) => {\n  return (\n    // Deliberately exclude Firefox Mobile, because its Web Share API isn't working correctly\n    browser.name?.toUpperCase().indexOf('FIREFOX') === -1 &&\n    webShareApiDeviceTypes.indexOf(device.type ?? '') !== -1 &&\n    navigator.canShare &&\n    navigator.canShare(shareData) &&\n    navigator.share\n  )\n}\n\nconst getEmojiTiles = (isDarkMode: boolean, isHighContrastMode: boolean) => {\n  let tiles: string[] = []\n  tiles.push(isHighContrastMode ? 'ğŸŸ§' : 'ğŸŸ©')\n  tiles.push(isHighContrastMode ? 'ğŸŸ¦' : 'ğŸŸ¨')\n  tiles.push(isDarkMode ? 'â¬›' : 'â¬œ')\n  return tiles\n}\n"]},"metadata":{},"sourceType":"module"}